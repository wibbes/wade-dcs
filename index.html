<html>
  <body>
  <p id='Button-Control'>
  <button onclick="start()">Start</button>
  <button onclick="stop()">Stop</button>
  <button onclick="clearc()">Clear</button>
  <button onclick="onceData()">Once</button>
  <button onclick="TrackHead()">Track Head</button>
  </p>
  
    <p id='server-time'></p>
	<p id='Head6HozAct'></p>
	<p id='log'></p>
    <script src="/socket.io/socket.io.js"></script>
    <script>
		var running = true;
		var once = false;
	
		var socket = io();
		var el = document.getElementById('server-time');
		var head6HozAct = document.getElementById('Head6HozAct');
		var log = document.getElementById('log');
  
	   
		socket.on('time', function(timeString) {
			el.innerHTML = 'Server time: ' + timeString;
		});
		
		socket.on('PLC-Data', function(data) {
		
		obj = JSON.parse(data)
			if (running == true){
			if (once == false){
				addData(data);
			}
			}
			if (once == true) {
			//console.log("Test 1");
			//console.log(obj);
			//console.log(obj.MachineID);
			if (onceUnused.includes(obj.MachineID)){
			//console.log("Test 2");
				var index = onceUnused.indexOf(obj.MachineID);
				if (index > -1) {
				
					onceUnused.splice(index, 1);
			
				}
			
				addData(data);
			
			}
			
			
			}
		});
		
		function addData(data){
		
		//console.log(data);
			
				obj = JSON.parse(data)
				//console.log(obj.MachineID);
				if (obj.MachineID == "6"){
				
				head6HozAct.innerHTML = obj.Positions.VertialAxis.ActualPosition;
				
				}
			
				console.log(obj);
	 
				log.innerHTML = log.innerHTML + data + '<br /> ';
		}
	  
		function start() {
			running = true;
			once = false;
			clearc();
		}
		
		
		
		function stop() {
			running = false;	
			once= false;
		}
		function clearc() {
			
			console.clear();
			console.log("Console was cleared");
		}
		
		var onceUnused;
		function onceData(){
		clearc();
		running = false;
		once = true;
		onceUnused = ["12","11","10","9","8","7","6","5","4","3","2","1"];
		log.innerHTML = "";
		}
		
	  
	
    </script>
  </body>
</html>
