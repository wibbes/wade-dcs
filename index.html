<html>
  <body>
  <p id='Button-Control'>
  <button onclick="start()">Start</button>
  <button onclick="stop()">Stop</button>
  <button onclick="clearc()">Clear</button>
  <button onclick="onceData()">Once</button>
  <button onclick="Logging()">Logging</button>
  <input type="text" id="Head">
  </p>
  
    <p id='server-time'></p>
	<p id='Heada'></p>
	<p id='count'></p>
	<p id='log'></p>
    <script src="/socket.io/socket.io.js"></script>
    <script>
		var running = true;
		var once = false;
		var loging = false;
	 var count1  = 0;
	 var count2 = 0;
		var socket = io();
		var el = document.getElementById('server-time');
		var heada = document.getElementById('Heada');
		var log = document.getElementById('log');
		var count = document.getElementById('count');
  var head = document.getElementById('Head');
  setInterval(qwas, 1000);
  function qwas()
  {
  count2 = count2 + 1;
  count.innerHTML = count1 + " " + count2;
  }
	   
		socket.on('time', function(timeString) {
			el.innerHTML = 'Server time: ' + timeString;
		});
		
		socket.on('PLC-Data', function(data) {
		
		obj = JSON.parse(data)
			if (running == true){
			if (once == false){
				addData(data);
			}
			}
			if (once == true) {
			//console.log("Test 1");
			//console.log(obj);
			//console.log(obj.MachineID);
			if (onceUnused.includes(obj.MachineID)){
			//console.log("Test 2");
				var index = onceUnused.indexOf(obj.MachineID);
				if (index > -1) {
				
					onceUnused.splice(index, 1);
			
				}
			
				addData(data);
			
			}
			
			
			}
		});
		
		function addData(data){
		
		//console.log(data);
			
				obj = JSON.parse(data)
				
				//console.log(obj.MachineID);
				
					heada.innerHTML = 'Vertial Axis:' + obj.Head5.Positions.VertialAxis.ActualPosition + '<br />';
					heada.innerHTML = heada.innerHTML + 'Hozizontal Axis:' + obj.Head5.Positions.HozizontalAxis.ActualPosition + '<br />';
					heada.innerHTML = heada.innerHTML + 'Nomial Pressure:' + obj.Head5.Pressures.NomialPressure + '<br />';
					heada.innerHTML = heada.innerHTML + 'Actual Pressure:' + obj.Head5.Pressures.ActualPressure + '<br />';
					
					count1 = count1 + 1;
					
				
			
				
	 if (loging == true){
				log.innerHTML = log.innerHTML + data + '<br /> ';
				console.log(obj);
				}
		}
	  
		function start() {
			running = true;
			once = false;
			clearc();
			count1= 0;
			count2= 0;
		}
		
		function Logging(){
		
		clearc();
		
		log.innerHTML = "";
		if (loging ==true)
		{
		loging = false;
		}else{
		loging = true;
		}
		
		}
		
		function stop() {
			running = false;	
			once= false;
		}
		function clearc() {
			
			console.clear();
			console.log("Console was cleared");
		}
		
		var onceUnused;
		function onceData(){
		clearc();
		running = false;
		once = true;
		onceUnused = ["12","11","10","9","8","7","6","5","4","3","2","1"];
		log.innerHTML = "";
		}
		
	  
	
    </script>
  </body>
</html>
